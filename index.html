<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Decoding — Target: BitCoin</title>
<style>
  :root{
    --bg:#070809;
    --panel:#0b0c0d;
    --accent:#2aff9b;
    --muted:#8b8f95;
    --header-height:34px;
    --gutter:10px;
  }
  html,body{height:100%;margin:0;background:linear-gradient(180deg,#020204 0%, #0a0b0c 100%);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;color:var(--accent);-webkit-font-smoothing:antialiased}
  .app{box-sizing:border-box;padding:12px;height:100%;display:flex;flex-direction:column;gap:12px}

  .toolbar{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  .brand{font-weight:700;color:#bfffdc;font-size:14px}
  .control{margin-left:auto;display:flex;gap:8px;align-items:center}
  .btn{background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.05);padding:6px 10px;border-radius:6px;color:var(--accent);cursor:pointer;font-size:13px}
  .btn:active{transform:translateY(1px)}
  .smallInput{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:6px 8px;border-radius:6px;color:var(--accent);width:70px}
  label.switch{display:inline-flex;gap:6px;align-items:center;color:var(--muted);font-size:13px;user-select:none}
  .switch input{transform:scale(1.1)}

  .grid{display:grid;gap:var(--gutter);flex:1;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));align-content:start}

  .terminal{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:8px;box-shadow:0 6px 20px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.02);overflow:hidden;display:flex;flex-direction:column;min-height:180px;border:1px solid rgba(255,255,255,0.04);position:relative}
  .term-header{height:var(--header-height);display:flex;align-items:center;gap:8px;padding:0 10px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-bottom:1px solid rgba(255,255,255,0.05);color:var(--muted);font-size:13px}
  .dots{display:flex;gap:6px;align-items:center}
  .dot{width:11px;height:11px;border-radius:50%;background:#ff5f56;box-shadow:inset 0 -1px 0 rgba(0,0,0,0.25)}
  .dot.yellow{background:#ffbd2e}
  .dot.green{background:#27c93f}
  .term-title{margin-left:8px;font-weight:600;color:#d6ffe8;font-size:13px}

  .term-body{padding:10px;overflow:auto;flex:1;min-height:0;font-size:13px;line-height:1.4}
  .line{white-space:pre;display:block}
  .muted{color:rgba(180,200,190,0.32)}
  .kw{color:#9bdfff}
  .str{color:#ffd28a}
  .num{color:#ff9ccd}
  .comment{color:#5a6b66}
  .cursor{display:inline-block;width:8px;height:14px;background:var(--accent);margin-left:4px;vertical-align:middle;animation:blink 1s steps(1) infinite}
  @keyframes blink{50%{opacity:0}}

  .term-footer{padding:6px 10px;border-top:1px solid rgba(255,255,255,0.05);display:flex;gap:8px;align-items:center;font-size:12px;color:var(--muted);background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent)}
  .term-footer .mini-btn{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:4px 6px;border-radius:6px;color:var(--muted);cursor:pointer;font-size:12px}
  .hidden{display:none}

  .term-body::-webkit-scrollbar{width:8px}
  .term-body::-webkit-scrollbar-thumb{background:rgba(255,255,255,0.08);border-radius:8px}
</style>
</head>
<body>
<div class="app">
  <div class="toolbar">
    <div class="brand">Decoding — Target: BitCoin</div>
    <div style="margin-left:12px;color:var(--muted);font-size:13px">Auto-decode - Progress: Visible.</div>

    <div class="control">
      <label style="color:var(--muted);font-size:13px">Terminals</label>
      <input id="termCount" class="smallInput" type="number" value="4" min="1" max="12" />
      <button class="btn" id="applyCount">Apply</button>
      <button class="btn" id="pauseAll">Pause All</button>
      <button class="btn" id="resumeAll">Resume All</button>
      <button class="btn" id="randomize">Randomize</button>
      <label class="switch"><input id="autoFollow" type="checkbox" checked /> Stay in view</label>
    </div>
  </div>

  <div id="grid" class="grid" aria-live="polite"></div>
</div>

<script>
/* ---------------------------
   Terminal Matrix Simulation
   --------------------------- */

const SAMPLE_SNIPPETS = [
  'sudo nmap -sS -p- 10.0.{RND}.{RND}',
  'Connecting to backbone node: NODE-{HEX}',
  'decrypting /etc/secure/config => ok',
  'TRACE ROUTE: 192.168.{RND}.{RND} -> {IP}',
  'auth: token verified (uid: {UID})',
  'git fetch --all && git reset --hard origin/main',
  'python3 tools/scan_ports.py --fast --threads=12',
  '[INFO] Processed {NUM} packets in {NUM}ms',
  'watchdog: heartbeat lost on interface eth{RND}',
  'DB_WRITE /var/log/trace.log: "session {TIME} started"',
  'alloc(0x{HEX}, {NUM}) = PTR_OK',
  '>>> payload:[{HEX}{HEX}{HEX}]',
  'ssh root@host-{RND}.{RND}.{RND}.{RND} -p {NUM}',
  'SSL cert chain validated: issuer=GLOBAL-CA',
  'rm -rf /tmp/cache_{UID}/* || true',
  'while true; do echo "still running"; sleep 1; done',
  'SERVICE: firewalled? {BOOL} - status: {STATUS}',
  '>>> ECHO "INTRUSION DETECTED" | wall',
  'Parsing log: failed={NUM}, ok={NUM}, ignored={NUM}',
  'payload.size={NUM} bytes -> chunked into {NUM} blocks'
];

function rnd(min=0,max=1000){ return Math.floor(Math.random()*(max-min+1))+min }
function hex(len=4){ let s=''; for(let i=0;i<len;i++) s += Math.floor(Math.random()*16).toString(16); return s }
function uid(){ return Math.floor(Math.random()*9000)+1000 }
function timestr(){ const d=new Date(); return d.toLocaleTimeString() }

function fillPlaceholders(s){
  return s.replace(/\{RND\}/g,()=>rnd(1,254))
          .replace(/\{HEX\}/g,()=>hex(4))
          .replace(/\{UID\}/g,()=>uid())
          .replace(/\{NUM\}/g,()=>rnd(1,9999))
          .replace(/\{IP\}/g,()=>['10.0.0.1','172.16.8.4','203.120.45.2'][rnd(0,2)])
          .replace(/\{BOOL\}/g,()=>Math.random()>0.5?'true':'false')
          .replace(/\{STATUS\}/g,()=>['OK','WARN','FAIL'][rnd(0,2)])
          .replace(/\{TIME\}/g,()=>new Date().toISOString())
}

class Terminal {
  constructor(id, parent){
    this.id = id;
    this.parent = parent;
    this.paused = false;
    this.visible = true;
    this.createElement();
    this.start();
  }

  createElement(){
    const el = document.createElement('div');
    el.className = 'terminal';
    el.innerHTML = `
      <div class="term-header">
        <div class="dots">
          <span class="dot"></span>
          <span class="dot yellow"></span>
          <span class="dot green"></span>
        </div>
        <div class="term-title">root@matrix-${this.id.toString().padStart(2,'0')} ~</div>
        <div style="margin-left:auto;display:flex;gap:6px;align-items:center">
          <button class="mini action-close" title="Close">✕</button>
          <button class="mini action-toggle" title="Hide">—</button>
        </div>
      </div>
      <div class="term-body" role="log" aria-atomic="false"></div>
      <div class="term-footer">
        <div class="muted">status: <span class="status">running</span></div>
        <div style="flex:1"></div>
        <button class="mini-btn pause">Pause</button>
        <button class="mini-btn resume hidden">Resume</button>
      </div>
    `;
    this.el = el;
    this.body = el.querySelector('.term-body');
    this.statusEl = el.querySelector('.status');
    this.pauseBtn = el.querySelector('.pause');
    this.resumeBtn = el.querySelector('.resume');
    this.closeBtn = el.querySelector('.action-close');
    this.toggleBtn = el.querySelector('.action-toggle');

    this.pauseBtn.addEventListener('click',()=>this.pause());
    this.resumeBtn.addEventListener('click',()=>this.resume());
    this.closeBtn.addEventListener('click',()=> this.hide());
    this.toggleBtn.addEventListener('click',()=> this.toggleVisibility());

    this.parent.appendChild(el);
  }

  start(){
    this.loop = setInterval(()=>{
      if(this.paused || !this.visible) return;
      const burst = Math.random() < 0.12;
      if(burst){
        const n = rnd(2,6);
        for(let i=0;i<n;i++) this.pushRandomLine(10 + i*200);
      } else {
        this.pushRandomLine();
      }
    }, rnd(350,900));
  }

  pushRandomLine(delay=0){
    const snippet = fillPlaceholders(SAMPLE_SNIPPETS[rnd(0,SAMPLE_SNIPPETS.length-1)]);
    const prefix = (Math.random()<0.25) ? `[${timestr()}] ` : '';
    setTimeout(()=> this.typeLine(prefix + snippet), delay);
  }

  typeLine(text){
    const lineEl = document.createElement('div');
    lineEl.className = 'line';

    // syntax tinting
    const parts = text.split(/(\s+)/);
    parts.forEach(token=>{
      const span = document.createElement('span');
      if(/\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}/.test(token)) span.className='num';
      else if((token.startsWith('[')&&token.endsWith(']'))||token.includes('TRACE')||token.includes('time')) span.className='comment';
      else if(token.includes('"')||token.includes("'")||token.includes('payload')) span.className='str';
      else if(/^(sudo|git|python|ssh|rm|alloc|watchdog)/.test(token)) span.className='kw';
      span.textContent = token;
      lineEl.appendChild(span);
    });

    const cursor = document.createElement('span'); cursor.className='cursor';
    lineEl.appendChild(cursor);
    this.body.appendChild(lineEl);

    // progressive typing
    const children = Array.from(lineEl.childNodes).filter(n=> n!==cursor);
    let queue = [];
    children.forEach(node=>{
      const txt = node.textContent;
      node.textContent = '';
      for(const ch of txt) queue.push({node,ch});
    });

    let i=0;
    const step = ()=>{
      if(this.paused || !this.visible){ setTimeout(step,120); return; }
      if(i<queue.length){
        const {node,ch} = queue[i++];
        node.textContent += ch;
        if(Math.random()<0.004){ node.classList.add('comment'); setTimeout(()=>node.classList.remove('comment'), 400); }
        ensureFollow(this.body);
        setTimeout(step, rnd(6,18));
      } else {
        cursor.remove();
        this.trimAndCycle();
        ensureFollow(this.body);
      }
    };
    setTimeout(step, rnd(6,30));
  }

  trimAndCycle(){
    // Keep newest chunk so it never scrolls far away
    const lines = this.body.querySelectorAll('.line');
    if(lines.length > 140){
      // keep last 80 lines
      for(let i=0;i<lines.length-80;i++) lines[i].remove();
    }
  }

  pause(){ this.paused = true; this.statusEl.textContent='paused'; this.pauseBtn.classList.add('hidden'); this.resumeBtn.classList.remove('hidden'); }
  resume(){ this.paused = false; this.statusEl.textContent='running'; this.pauseBtn.classList.remove('hidden'); this.resumeBtn.classList.add('hidden'); }
  hide(){ this.el.classList.add('hidden'); this.visible=false; this.statusEl.textContent='hidden'; }
  show(){ this.el.classList.remove('hidden'); this.visible=true; this.statusEl.textContent='running'; }
  toggleVisibility(){ this.visible ? this.hide() : this.show(); }
  destroy(){ clearInterval(this.loop); this.el.remove(); }
}

/* ---------- manager ---------- */
const grid = document.getElementById('grid');
let terminals = [];
let followEnabled = true;

function buildGrid(count){
  terminals.forEach(t=> t.destroy());
  terminals = [];
  grid.innerHTML = '';
  for(let i=1;i<=count;i++) terminals.push(new Terminal(i, grid));
}

buildGrid(4);

/* global controls */
document.getElementById('applyCount').addEventListener('click', ()=>{
  const v = parseInt(document.getElementById('termCount').value) || 4;
  const clamped = Math.max(1, Math.min(12, v));
  document.getElementById('termCount').value = clamped;
  buildGrid(clamped);
});
document.getElementById('pauseAll').addEventListener('click', ()=> terminals.forEach(t=> t.pause()));
document.getElementById('resumeAll').addEventListener('click', ()=> terminals.forEach(t=> t.resume()));
document.getElementById('randomize').addEventListener('click', ()=>{
  terminals.forEach(t=>{
    const bursts = rnd(3,8);
    for(let i=0;i<bursts;i++) t.pushRandomLine(i*80);
  });
});
document.getElementById('autoFollow').addEventListener('change', e=>{
  followEnabled = !!e.target.checked;
});

/* Always keep latest lines visible when enabled */
function ensureFollow(scroller){
  if(!followEnabled) return;
  // jump to bottom smoothly without jank
  scroller.scrollTop = scroller.scrollHeight;
}

/* Safety net: in case the browser throttles animations while idle,
   nudge scrollers to bottom periodically so spectators always see the newest lines. */
setInterval(()=>{
  if(!followEnabled) return;
  terminals.forEach(t=>{
    if(!t.visible || t.paused) return;
    t.body.scrollTop = t.body.scrollHeight;
  });
}, 800);

/* keyboard shortcuts */
window.addEventListener('keydown', (e)=>{
  if(e.key === 'p') terminals.forEach(t => t.paused ? t.resume() : t.pause());
  if(e.key === 'r') terminals.forEach(t => t.resume());
  if(e.key === 'b') document.getElementById('randomize').click();
});
</script>
</body>
</html>
